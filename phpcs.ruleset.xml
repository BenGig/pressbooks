<?xml version="1.0"?>
<ruleset>
    <!-- Use Pressbooks Coding Standards -->
    <rule ref="vendor/pressbooks/coding-standards">
        <!-- TODO: This should be enabled sooner than later... -->
        <exclude name="WordPress.WP.I18n.MissingTranslatorsComment"/>
    </rule>
    <rule ref="PSR1.Methods.CamelCapsMethodName">
        <!-- Exclude classes that override WP Core: -->
        <exclude-pattern>/inc/admin/class-catalog-list-table.php</exclude-pattern>
        <exclude-pattern>/inc/admin/class-network-managers-list-table.php</exclude-pattern>
        <exclude-pattern>/api/endpoints/controller/*</exclude-pattern>
        <exclude-pattern>/inc/modules/export/class-table.php</exclude-pattern>
    </rule>
    <!-- Disable Side Effects and MissingNamespace rules for bootstrapping files: -->
    <rule ref="PSR1.Files.SideEffects">
        <exclude-pattern>/pressbooks.php</exclude-pattern>
        <exclude-pattern>/functions.php</exclude-pattern>
        <exclude-pattern>/compatibility.php</exclude-pattern>
    </rule>
    <rule ref="HM.Functions.NamespacedFunctions.MissingNamespace">
        <exclude-pattern>/pressbooks.php</exclude-pattern>
        <exclude-pattern>/functions.php</exclude-pattern>
        <exclude-pattern>/compatibility.php</exclude-pattern>
    </rule>
    <!-- Disable all rules for these files: -->
    <exclude-pattern>/hm-autoloader.php</exclude-pattern>
    <exclude-pattern>*.blade.php</exclude-pattern>

	<!-- Security rules: -->
	<!-- BadFunctions -->
	<!-- PHP functions that can lead to security issues -->
	<rule ref="Security.BadFunctions.Asserts"/>
	<rule ref="Security.BadFunctions.Backticks"/>
	<rule ref="Security.BadFunctions.CallbackFunctions"/>
	<rule ref="Security.BadFunctions.CryptoFunctions"/>
	<rule ref="Security.BadFunctions.EasyRFI"/>
	<rule ref="Security.BadFunctions.EasyXSS">
		<properties>
			<!-- Comment out to follow global ParanoiaMode -->
			<property name="forceParanoia" value="1"/>
		</properties>
	</rule>
	<rule ref="Security.BadFunctions.ErrorHandling"/>
	<rule ref="Security.BadFunctions.FilesystemFunctions"/>
	<rule ref="Security.BadFunctions.FringeFunctions"/>
	<rule ref="Security.BadFunctions.FunctionHandlingFunctions"/>
	<rule ref="Security.BadFunctions.Mysqli"/>
	<rule ref="Security.BadFunctions.NoEvals"/>
	<rule ref="Security.BadFunctions.Phpinfos"/>
	<rule ref="Security.BadFunctions.PregReplace"/>
	<rule ref="Security.BadFunctions.SQLFunctions"/>
	<rule ref="Security.BadFunctions.SystemExecFunctions"/>

	<!-- CVE -->
	<!-- Entries from CVE database from vendor PHP and bugs.php.net -->
	<rule ref="Security.CVE.20132110"/>
	<rule ref="Security.CVE.20134113"/>

	<!-- Misc -->
	<rule ref="Security.Misc.BadCorsHeader"/>
	<rule ref="Security.Misc.IncludeMismatch"/>
</ruleset>
